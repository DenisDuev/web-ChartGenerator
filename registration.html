<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Chart generator</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="javascript/menu.js"></script>
    <script src="javascript/submit.js"></script>
    <script src="javascript/utils.js"></script>
    <script src="javascript/registration.js"></script>
</head>
<body>
<div class="header">
    <h1>Chart generator</h1>
</div>

<div id="navbar">
    <a href="home.html">Home</a>
    <a href="generatedDiagrams.html">My diagrams</a>
    <a href="#mockitoAndWeb">Lorem</a>
    <a href="#intoREST">Lorem</a>
    <ul>
        <li id="user"><a href="login.html"><img src="image/user_icon.png" alt="user" height="26" width="26"></a></li>
    </ul>
</div>
<div id="container">
    <div style="float: left; width: 25%; height: 80%;"><span style="color: white">.</span></div>
    <div class="block" style="overflow: hidden">
        <div class="header">
            <span>REGISTRATION</span>
        </div>
        <div class="center" style="border: none;">

            <input type="text" placeholder="username" id="username"/><br>
            <input type="password" placeholder="password" id="password"/><br>
			<input type="confirm_password" placeholder="ConfirmPassword" id="confirm_password"/><br>
            <input type="submit" value="REGISTRATION" onclick="register()"/>

        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
</body>
<script>

    function register() {
        var user = document.getElementById("username").value;
        var pass = document.getElementById("password").value;

		if (!isPasswordValid(pass)) {
                return;
            }
		
        var data = JSON.stringify({
            "username": user,
            "password": pass
        });
        $.ajax({
            url: '/javascript/registration',
            type: 'POST',
            data: data,
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var res = JSON.parse(data);
                if (res.status === true) {
                    var location = window.location.href;
                    window.location.href = location.replace("/registration", "/home");
                    alert("registration successful");
                } else {
                    alert("registration failed");
                }
            }
        });
    }
	function isPasswordValid(pass) {
            var confirmPass = document.getElementById("confirm_password").value;

            if (pass == "" || confirmPass == "") {
                alert("All fields are required");
                return false;
            }

            if (pass != confirmPass) {
                alert("The passwords don't match");
                return false;
            }
            return true;
        }
</script>
</html>